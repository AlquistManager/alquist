name: greet_flow
states:
  greet:
    type: message_text
    properties:
      text: 'Dobrý den'
      delay: 1000

  greet_name:
    type: message_text_random # Sends one of the messages listed under responses
    properties:
      responses: # List of responses
        - Moje jméno je Primus.
        - Jmenuji se Primus.
        - Já jsem Primus.
      delay: 1000

  greet_explain:
    type: message_text_random # Sends one of the messages listed under responses
    properties:
      responses: # List of responses
        - 'Rád Vám pomohu s výběrem a nákupem takového mobilního telefonu, který splní všechny vaše požadavky.'
        - 'Pomohu Vám vybrat mobilní telefon přesně podle vašich požadavků.'
      delay: 1000

  greet_ask:
    type: message_text_random # Sends one of the messages listed under responses
    properties:
      responses: # List of responses
        - Můžeme začít?
        - Jste připraveni začít?
      delay: 1000

  can_start_ask_buttons:
    type: message_buttons # shows buttons
    properties:
      buttons: # list of buttons to show
        - label: Ano # label of the first button
          next_state: greet_start # next_state after click on the first button
        - label: Ne # label of the second button
          next_state: goodbye # next_state after click on the second button

  can_start_ask:
    type: input_user # Prompts cliends and waits for his response
    properties:
      entities: # List of entities expected in client's answer
        yes_no: yes_no # context key: entity
      require_match: true # determines if expected entities are required
    transitions:
      match: can_start # transition when the entities are matched
      notmatch: error_can_start_buttons # transition when the entities are not matched

  error_can_start_buttons:
    type: message_buttons # shows buttons
    properties:
      buttons: # list of buttons to show
        - label: Ano # label of the first button
          next_state: greet_start # next_state after click on the first button
        - label: Ne # label of the second button
          next_state: goodbye # next_state after click on the second button

  error_can_start:
    type: message_text_random # Sends one of the messages listed under responses
    properties:
      responses: # List of responses
        - Omlouvám se, ale nerozuměl jsem vám. Jste připraveni začít s výběrem telefonu?
        - Promiňte, ale nerozuměl jsem, chcete pomoc s výběrem telefonu?
    transitions:
      next_state: can_start_ask

  can_start:
    type: conditional_equal
    properties:
      value1: '{{yes_no}}' # Here we use value of a context key intent
      value2: 'yes' # We compare string "greeting"
    transitions: # defines transition states for both branches
      equal: greet_start # transition for when values are equal
      notequal: goodbye # transition for when values are not equal

  greet_start:
    type: message_text_random # Sends one of the messages listed under responses
    properties:
      responses: # List of responses
        - Výborně
        - Skvělě
        - Super
      delay: 1000
    transitions:
      flow: main_flow

  goodbye:
    type: message_text
    properties:
      text: 'Pokud změníte názor, prosím aktvujte mne klitkutím na panel v pravém dolním rohu obrazovky.'
